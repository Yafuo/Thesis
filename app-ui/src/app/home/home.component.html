<div class="wrap-content">
  <mat-sidenav-container class="example-container" (backdropClick)="sidenav.close()">
    <mat-sidenav class="bg-dark" #sidenav>
      <fa-icon (click)="sidenav.close()" [icon]="faChevronLeft" size="2x" [styles]="{'color': 'white'}"></fa-icon>
      <div class="sidenav-opt text-white" (click)="navTo(i)" *ngFor="let l of list; index as i">
        <fa-icon [icon]="navBarList[i]"></fa-icon>
        {{l.opt| translate}}
        <div (click)="_setLang(d.code)" class="sidenav-opt-details text-white" *ngFor="let d of l.details">
          {{d.name | translate}}
        </div>
      </div>
    </mat-sidenav>
    <mat-sidenav-content>
      <div class="wrap-tools row mr-0">

        <mat-form-field class="pl-4 col-8">
          <input matInput type="text" placeholder="{{'Search' | translate}} ..." [formControl]="allSearch" [matAutocomplete]="all">
          <mat-icon class="search-fn" matSuffix>search</mat-icon>
          <mat-autocomplete autoActiveFirstOption #all="matAutocomplete">
            <mat-option *ngFor="let d of filterAllSearchList | async" [value]="d">
              {{d}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <span class="col-4 text-center pt-2 p-0">
      <button class="filter-btn" mat-stroked-button color="primary" (click)="toggleFilter()"><mat-icon matPrefix>filter_list</mat-icon> {{'Filter' | translate}}</button>
    </span>

      </div>
      <div *ngIf="isShowResult && !isFilterClicked" class="wrap-result row align-items-center">
<!--        <div *ngIf="true" class="wrap-result row align-items-center">-->
        <div class="col-1"></div>
        <div class="col-10">
          <fieldset *ngIf="isAvailable" class="p-2" style="border: 1px #28a745 solid">
            <legend class="w-auto"><span class="badge badge-success">{{'Result' | translate}}</span></legend>
            <p *ngIf="userInfo.status === 'none' && !isTimeValid" class="badge badge-danger">{{'This time has passed. Please choose another time!'}}</p>
            <fa-icon [icon]="faCheckCircle" [styles]="{'color': 'green'}"></fa-icon>
            <span class="{{'text-success'}}">{{'Available' | translate}}</span>
            <button [disabled]="qrUrl || userInfo.status != 'none' || !isTimeValid" (click)="_book()" class="btn btn-sm btn-success float-right">{{'Booking' | translate}}</button>
          </fieldset>
          <fieldset *ngIf="!isAvailable" class="p-2" style="border: 1px #dc3545 solid">
            <legend class="w-auto"><span class="badge badge-danger">{{'Result' | translate}}</span></legend>
            <fa-icon [icon]="faTimesCircle" [styles]="{'color': 'red'}"></fa-icon>
            <span class="text-danger">{{'Not Available' | translate}}</span>
            <button disabled class="btn btn-sm btn-primary float-right">{{'Booking' | translate}}</button>
          </fieldset>
        </div>
        <div class="col-1"></div>
<!--        <owl-date-time pickerType="timer" #ultiTime></owl-date-time>-->
      </div>
      <div *ngIf="qrUrl" class="wrap-qr-code overflow-auto">
        <img src="{{qrUrl}}" style="width: 50vw">
      </div>
      <div class="wrap-filter hide-this-{{!isFilterClicked}}">
        <div class="abc row mr-0">
          <mat-form-field class="pl-4 col-8">
            <mat-icon [inline]="true" class="search-fn" matPrefix>location_searching</mat-icon>
            <input matInput type="text" placeholder=" {{'Choose destination' | translate}}" [formControl]="parkingStationControl" [matAutocomplete]="destination">
            <mat-autocomplete autoActiveFirstOption #destination="matAutocomplete">
              <mat-option *ngFor="let add of filterparkingStationList | async" [value]="add">
                <span style="font-size: 14px">{{add}}</span>
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
        </div>
        <div class="abc row mr-0">
          <mat-form-field class="pl-4 col-8">
            <mat-icon [inline]="true" class="search-fn" matPrefix>location_on</mat-icon>
            <input matInput type="text" placeholder=" {{'Choose start location' | translate}}" [formControl]="userLocationControl"
                   [matAutocomplete]="startLocation">
            <mat-autocomplete autoActiveFirstOption #startLocation="matAutocomplete">
              <mat-option *ngFor="let add of filterUserLocationList | async" [value]="add">
                <span style="font-size: 14px">{{add}}</span>
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
          <div class="pl-0 col-4 d-flex align-items-center">
            <mat-checkbox style="font-size: small" [(ngModel)]="isCurrentLocationChecked">{{'Your location' | translate}}</mat-checkbox>
          </div>
        </div>
        <mat-accordion [hideToggle]="true">
          <mat-expansion-panel class="abc m-2" (opened)="display('up')" (closed)="display('down')">
            <mat-expansion-panel-header style="font-size: 14px" class="row">
              <mat-panel-title class="col-2 col-sm-2 p-0">
                {{'Package' | translate}}
              </mat-panel-title>
              <mat-panel-description class="col-8 col-sm-8 p-0 mr-0">
                <span>{{'Helps us to find available slot' | translate}}</span>
              </mat-panel-description>
              <mat-panel-description class="col-2 col-sm-2 p-0">
                <div class=" indicator{{'-'+ state}}">
                  <mat-icon>keyboard_arrow_down</mat-icon>
                </div>
              </mat-panel-description>
            </mat-expansion-panel-header>
            <div class="row">
              <ul class="col-12 col-sm-6 pr-0 list-group">
                <li class="list-group-item" (click)="onSelect(p)" *ngFor="let p of packageList">{{p.name | translate}}</li>
              </ul>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
        <div class="abc time-picker row mt-3 ml-0 mr-0">
          <mat-form-field class="col-6 start-time">
            <input [owlDateTime]="startTime" [owlDateTimeTrigger]="startTime" matInput placeholder="{{'Start time' | translate}}"
                   [(ngModel)]="leaveHomeTime">
          </mat-form-field>
          <owl-date-time pickerType="timer" #startTime></owl-date-time>

          <mat-form-field class="col-6 ready-park-time">
            <input [owlDateTime]="readyParkTime" [owlDateTimeTrigger]="readyParkTime" matInput placeholder="{{'Estimate park time' | translate}}"
                   [(ngModel)]="arriveTime">
          </mat-form-field>
          <owl-date-time pickerType="timer" #readyParkTime></owl-date-time>
        </div>
        <div class="abc row">
          <div class="col-6"></div>
          <div class="col-6 text-center">
            <button [disabled]="!parkingStationControl.value || !userLocationControl.value || !selectedPackage.name" (click)="filter()" class="btn btn-sm btn-warning">{{'Done' | translate}}</button>
          </div>
        </div>
      </div>
      <div *ngIf="userInfo.status.indexOf('staked') > -1" class="wrap-feature-btn row">
        <div class="col-12 col-md-4 text-center" style="padding: 0 40px">
          <button [disabled]="userInfo.status === 'paid'" (click)="_park()" class="btn btn-sm btn-primary w-100">{{'Park' | translate}}</button>
        </div>
        <div class="col-12 col-md-4 text-center" style="padding: 0 40px">
          <button class="btn btn-sm btn-warning w-100" (click)="toggleExtend()">{{'Extend' | translate}}</button>
        </div>
        <div class="col-12 col-md-4 text-center" style="padding: 0 40px">
          <button class="btn btn-sm btn-danger w-100" (click)="_cancel()">{{'Cancel' | translate}}</button>
        </div>
        <div class="col-12 package-choice hide-this-{{!extend}}" style="padding: 0 40px">
          <mat-accordion [hideToggle]="true">
            <mat-expansion-panel class="abc m-2" (opened)="display('up')" (closed)="display('down')">
              <mat-expansion-panel-header style="font-size: 14px" class="row">
                <mat-panel-title class="col-2 col-sm-2 p-0">
                  <button [disabled]="!selectedPackage.name" class="btn btn-sm btn-primary btn-extend" (click)="_extend()">{{'Done' | translate}}</button>
                </mat-panel-title>
                <mat-panel-description class="col-8 col-sm-8 p-0 mr-0">
                  <span>{{'Please click Done when finish' | translate}}</span>
                </mat-panel-description>
                <mat-panel-description class="col-2 col-sm-2 p-0">
                  <div class=" indicator{{'-'+ state}}">
                    <mat-icon>keyboard_arrow_down</mat-icon>
                  </div>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <div class="row">
                <ul class="col-12 col-sm-6 pr-0 list-group">
                  <li class="list-group-item" (click)="onSelect(p)" *ngFor="let p of packageList">{{p.name | translate}}</li>
                </ul>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </div>
      </div>
      <fa-icon class="position-fixed" style="bottom: 0;right: 0;" (click)="sidenav.open()" [icon]="faBars" size="2x" [styles]="{'color': 'black'}"></fa-icon>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>
